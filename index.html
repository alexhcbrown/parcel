<!doctype html>
<html>
    <head>
        <title>Parser Thing</title>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.16.1/vis.min.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.16.1/vis.min.css"/>
        <link href="https://fonts.googleapis.com/css?family=Open+Sans|Roboto:100,400" rel="stylesheet">

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/styles/default.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <link rel="stylesheet" href="style.css"/>
        <script src="js/state.js"></script>
        <script src="js/animstate.js"></script>
        <script src="js/diagram.js"></script>
        <script>
            function genStateArray(c,i,a) {
                a = a || []; i = i || 1;
                if(!c) return a;
                a.push(new AnimState(String.fromCharCode(i+64)));
                return genStateArray(c-1,i+1,a);
            }
            var set1 = genStateArray(9),
                set2 = genStateArray(9);
            set1[0].add([set1[1],set1[2]]);
            set1[1].add([set1[3]]);
            //set1[3].add([set1[0]]);
            set2[4].add([set2[1],set2[6]]);
            set2[1].add([set2[3]]);
            set2[3].add([set2[6]]);
            set2[6].add([set2[4]]);
            set2[5].add([set2[1]]);
            //copy = set1[0].deepCopy();
        </script>
    </head>
    <body>
        <div class="wrap">
            <div class="diagram" id="diagramRef">
                <div id="testContainer" class="stateDiagram"></div>
            </div>
            <aside class="drawer">
                <header>
                    <span class="logoText">Hazel</span>
                    <span class="logoSubText">Parcel</span>
                    <div class="colorBar">
                        <div class="color"></div><div class="color"></div>
                        <div class="color"></div><div class="color"></div>
                    </div>
                </header>
                <h5>Grammar Rules</h5>
                <pre>
<code contenteditable="true" id="rules">{
"Rule":[["A","B"],["C","D"]]
}
</code>
                </pre>
                <p>These Grammar Rules are converted into a Finite State Machine.</p>
            </aside>
        </div>
        <script>
            var testContainer = document.getElementById('testContainer'),
                ref = document.getElementById("diagramRef"),
                rules = document.getElementById("rules"),
                diagramTest = new Diagram(
                    testContainer,
                    [set1[0],set2[4]]
                );
            diagramTest.onResize(() => {
                return [ref.offsetWidth-20,ref.offsetHeight-20];
            })
            diagramTest.makeLive();
            rules.addEventListener("blur",()=>{
                rules.innerHTML = hljs.highlightAuto(rules.innerText).value;
            });
        </script>
    </body>
</html>
